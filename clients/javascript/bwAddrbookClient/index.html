<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <title>Address Book</title>
    <link href="resources/reset.css" rel="stylesheet" type="text/css"/>
    <link href="resources/addressbook.css" rel="stylesheet" type="text/css"/>
    <script type="text/javascript" src="resources/jquery/jquery-1.4.2.min.js"></script>
    <script type="text/javascript" src="resources/jquery/jquery-ui-1.8.2.custom.min.js"></script>
    <script type="text/javascript">
      $(document).ready(function() {
        
        $("#auth").click(function() {
          $.ajax({
            type: "get",
            url: "/ucarddav/user/johnsa/addressbook/",
            //data: "format=json&addrbook=/user/johnsa/addressbook",
            dataType: "html",
            success: function(responseData){
              alert(responseData);            
            },
            error: function(msg) {
              // there was a problem
              alert(msg.statusText);
            }
          });
        });

        $("#report").click(function() {
          $.ajax({
            type: "report",
            url: "/ucarddav/user/johnsa/addressbook/",
            //data: "format=json&addrbook=/user/johnsa/addressbook",
            dataType: "xml",
            beforeSend: function(xhrobj) {
              xhrobj.setRequestHeader("X-HTTP-Method-Override", "REPORT");
            },
            success: function(responseData){
              alert(responseData);            
            },
            error: function(msg) {
              // there was a problem
              alert(msg.statusText);
            }
          });
        });

        $("#add").click(function() {
          vcData = "BEGIN:VCARD\nFN:Kyla Collings\nUID:BW:myveryhandcodeduid@mysite.edu:6754836\nCLASS:PRIVATE\nCATEGORIES:Services\nREV:20100211T041750Z\nTEL;TYPE=HOME:+1 518 273-5658\nADR;TYPE=HOME:;;58 Spring Ave;Troy;NY;12180;\nN:Collings;Kyla;;;\nVERSION:4.0\nEND:VCARD";
          $.ajax({
            type: "put",
            url: "/ucarddav/user/johnsa/addressbook/BW:myveryhandcodeduid@mysite.edu:6754836.vcf",
            data: vcData,
            dataType: "text",
            processData: false,
            beforeSend: function(xhrobj) {
              xhrobj.setRequestHeader("X-HTTP-Method-Override", "PUT");
              xhrobj.setRequestHeader("If-None-Match", "*");
            },
            success: function(responseData){
              alert(responseData);            
            },
            error: function(msg) {
              // there was a problem
              alert(msg.statusText);
            }
          });
        });

        
      });
    </script>
  </head>
  <body>
    <div id="header">
      <h1>Bedework Address Book</h1>
      <p>Test page</p>
      <ul>
        <li><button id="auth" type="button">Authenticate/Test</button></li>
        <li><button id="report" type="button">Report</button></li>
        <li><button id="add" type="button">Add a new vcard</button></li>
      </ul>
      
    </div>
  </body>
</html>